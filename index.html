<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>APP Store ¬∑ Â∫îÁî®Êî∂Ëóè</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background: #0a0a0c;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 16px 12px 0px;
            color: #ffffff;
        }

        .container {
            max-width: 400px;
            width: 100%;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 18px;
            padding-bottom: 90px;
        }

        /* Â§¥ÈÉ® */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 8px;
        }

        .logo-area {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo-icon {
            width: 44px;
            height: 44px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            font-weight: bold;
            color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            transition: background-color 0.3s;
        }

        /* ÂÆâÂçì/ËãπÊûúÈ¢úËâ≤‰ºöÂú®JS‰∏≠Âä®ÊÄÅËÆæÁΩÆ */
        .logo-icon.ios-theme {
            background: #1e88e5;
            box-shadow: 0 4px 12px rgba(30, 136, 229, 0.4);
        }

        .logo-icon.android-theme {
            background: #4CAF50;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
        }

        .logo-text {
            font-size: 22px;
            font-weight: 600;
            color: #fff;
        }

        .logo-text small {
            font-size: 13px;
            color: #888;
            font-weight: 400;
            margin-left: 4px;
        }

        .add-button {
            border: none;
            border-radius: 30px;
            padding: 10px 20px;
            font-size: 16px;
            font-weight: 500;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .add-button.ios-theme {
            background: #1e88e5;
            box-shadow: 0 4px 12px rgba(30, 136, 229, 0.3);
        }

        .add-button.android-theme {
            background: #4CAF50;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .add-button:active {
            transform: scale(0.96);
        }

        .add-button.ios-theme:active {
            background: #1565c0;
        }

        .add-button.android-theme:active {
            background: #388E3C;
        }

        /* ÊêúÁ¥¢Êù° */
        .search-bar {
            background: #1c1c1e;
            border: 1px solid #2c2c2e;
            border-radius: 30px;
            padding: 14px 18px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            width: 100%;
        }

        .search-bar span {
            font-size: 18px;
            color: #888;
        }

        .search-bar input {
            background: transparent;
            border: none;
            color: white;
            font-size: 16px;
            width: 100%;
            outline: none;
            cursor: pointer;
        }

        .search-bar input::placeholder {
            color: #555;
        }

        /* Â∫îÁî®Âç°ÁâáÁΩëÊ†º */
        .apps-grid {
            display: flex;
            flex-direction: column;
            gap: 16px;
            width: 100%;
            margin-top: 4px;
            padding-bottom: 20px;
        }

        .app-card {
            background: #1c1c1e;
            border-radius: 24px;
            padding: 16px;
            border: 1px solid #2c2c2e;
            display: flex;
            align-items: center;
            gap: 16px;
            position: relative;
            transition: all 0.2s;
        }

        .app-card:active {
            background: #2c2c2e;
            transform: scale(0.99);
        }

        .app-icon {
            width: 70px;
            height: 70px;
            border-radius: 20px;
            background: #2c2c2e;
            overflow: hidden;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 34px;
            border: 2px solid #3a3a3c;
            cursor: pointer;
        }

        .app-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .app-icon.placeholder {
            background: #2c2c2e;
            color: #555;
        }

        .app-info {
            flex: 1;
            min-width: 0;
            cursor: pointer;
        }

        .app-name {
            font-size: 18px;
            font-weight: 600;
            color: white;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .app-platform {
            font-size: 12px;
            background: #2c2c2e;
            padding: 3px 10px;
            border-radius: 20px;
            color: #aaa;
            display: inline-block;
            border: 0.5px solid #3a3a3c;
        }

        .app-url-preview {
            font-size: 12px;
            color: #888;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 180px;
            margin-bottom: 8px;
        }

        .download-badge {
            background: #1e88e5;
            color: white;
            font-size: 13px;
            font-weight: 600;
            padding: 6px 14px;
            border-radius: 30px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
            box-shadow: 0 2px 8px rgba(30, 136, 229, 0.3);
        }

        /* ‰∏ãËΩΩÂæΩÁ´†È¢úËâ≤‰πü‰ºöË∑üÈöèËÆæÂ§áÂèòÂåñ */
        .download-badge.ios-theme {
            background: #1e88e5;
            box-shadow: 0 2px 8px rgba(30, 136, 229, 0.3);
        }

        .download-badge.android-theme {
            background: #4CAF50;
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
        }

        .app-actions {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 8px;
        }

        .corner-btn {
            background: transparent;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #888;
            cursor: pointer;
            transition: all 0.2s;
        }

        .corner-btn.edit-btn:active {
            background: #2c2c2e;
        }

        .corner-btn.edit-btn.ios-theme:active {
            color: #1e88e5;
        }

        .corner-btn.edit-btn.android-theme:active {
            color: #4CAF50;
        }

        .corner-btn.delete-btn:active {
            background: #8b1e1e;
            color: white;
        }

        /* Á©∫Áä∂ÊÄÅ */
        .empty-message {
            text-align: center;
            padding: 60px 20px;
            color: #555;
            background: #1c1c1e;
            border-radius: 30px;
            border: 2px dashed #2c2c2e;
            margin-top: 30px;
        }

        .empty-message .big-icon {
            font-size: 54px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-message .hint {
            font-size: 14px;
            color: #777;
            margin-top: 8px;
        }

        /* Â∫ïÈÉ®ÂØºËà™Ê†è */
        .bottom-nav {
            position: fixed;
            bottom: 16px;
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 32px);
            max-width: 360px;
            background: rgba(28, 28, 30, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 40px;
            display: flex;
            justify-content: space-evenly;
            align-items: center;
            padding: 6px 4px;
            z-index: 100;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.8);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: transparent;
            border: none;
            color: #8e8e93;
            font-size: 11px;
            font-weight: 500;
            padding: 6px 0;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.2s;
            width: 60px;
            max-width: 60px;
            gap: 2px;
        }

        .nav-item.active {
            color: white;
            font-weight: 600;
            backdrop-filter: blur(5px);
        }

        .nav-item.active.ios-theme {
            background: rgba(30, 136, 229, 0.2);
        }

        .nav-item.active.android-theme {
            background: rgba(76, 175, 80, 0.2);
        }

        .nav-item i {
            font-size: 20px;
            font-style: normal;
        }

        /* ÂºπÁ™ó */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            padding: 16px;
        }

        .modal.show {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-card {
            background: #1c1c1e;
            width: 100%;
            max-width: 360px;
            border-radius: 32px;
            padding: 26px 22px;
            border: 1px solid #2c2c2e;
            max-height: 85vh;
            overflow-y: auto;
        }

        .modal-card h2 {
            font-size: 24px;
            color: #fff;
            margin-bottom: 22px;
            text-align: center;
        }

        .input-field {
            margin-bottom: 20px;
        }

        .input-field label {
            display: block;
            font-size: 14px;
            color: #aaa;
            margin-bottom: 6px;
            font-weight: 500;
        }

        .input-field input, .input-field select {
            width: 100%;
            padding: 15px 18px;
            background: #2c2c2e;
            border: 1px solid #3a3a3c;
            border-radius: 24px;
            font-size: 15px;
            color: white;
            outline: none;
        }

        .input-field input:focus {
            border-color: #1e88e5;
        }

        .url-input-row {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .url-input-row input {
            flex: 1;
        }

        .fetch-btn {
            background: #2c2c2e;
            border: 1px solid #3a3a3c;
            border-radius: 24px;
            padding: 15px 18px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            white-space: nowrap;
        }

        .fetch-btn:active {
            background: #3a3a3c;
        }

        .fetch-status {
            font-size: 12px;
            color: #1e88e5;
            margin-top: 6px;
        }

        .platform-selector {
            display: flex;
            gap: 12px;
            margin: 8px 0 16px;
        }

        .platform-option {
            flex: 1;
            background: #2c2c2e;
            border: 1px solid #3a3a3c;
            border-radius: 24px;
            padding: 14px;
            text-align: center;
            color: #aaa;
            cursor: pointer;
            transition: all 0.2s;
        }

        .platform-option.selected {
            background: #1e88e5;
            border-color: #1e88e5;
            color: white;
        }

        .platform-option i {
            font-size: 22px;
            display: block;
            margin-bottom: 4px;
        }

        .modal-actions {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-top: 28px;
        }

        .modal-btn {
            padding: 14px 28px;
            border-radius: 30px;
            border: 1px solid #3a3a3c;
            background: transparent;
            color: #ccc;
            cursor: pointer;
            min-width: 130px;
            font-size: 16px;
            font-weight: 500;
        }

        .modal-btn.primary {
            background: #1e88e5;
            color: white;
            border-color: #1e88e5;
        }

        .modal-btn.primary:active {
            background: #1565c0;
        }

        .modal-btn.secondary:active {
            background: #2c2c2e;
        }

        .hint-text {
            font-size: 12px;
            color: #777;
            margin-top: 4px;
        }

        /* ÊêúÁ¥¢È°µ */
        .search-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0a0a0c;
            z-index: 200;
            display: none;
            flex-direction: column;
            padding: 20px 16px 0;
            overflow-y: auto;
        }

        .search-overlay.show {
            display: flex;
        }

        .search-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .back-btn {
            background: #1c1c1e;
            border: 1px solid #2c2c2e;
            border-radius: 30px;
            padding: 12px 20px;
            color: white;
            font-size: 16px;
            cursor: pointer;
        }

        .search-input-box {
            flex: 1;
            display: flex;
            align-items: center;
            background: #1c1c1e;
            border: 1px solid #2c2c2e;
            border-radius: 30px;
            padding: 12px 18px;
        }

        .search-input-box input {
            background: transparent;
            border: none;
            color: white;
            font-size: 16px;
            width: 100%;
            outline: none;
        }

        .search-results {
            display: flex;
            flex-direction: column;
            gap: 16px;
            flex: 1;
            padding-bottom: 20px;
        }

        .version-toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 14px 28px;
            border-radius: 40px;
            font-size: 16px;
            z-index: 300;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            border: 1px solid #555;
        }
        .version-toast.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="version-toast" id="versionToast">APP Store ¬∑ ËÆæÂ§áËá™ÈÄÇÂ∫î</div>

    <div class="container">
        <!-- Â§¥ÈÉ® -->
        <div class="header">
            <div class="logo-area">
                <div class="logo-icon" id="logoIcon">C</div>
                <div class="logo-text">APP Store<span>Êî∂Ëóè</span></div>
            </div>
            <div class="add-button" id="openAddModalBtn">
                <span>+</span> Ê∑ªÂä†
            </div>
        </div>

        <!-- ÊêúÁ¥¢Êù° -->
        <div class="search-bar" id="openSearchBtn">
            <span>üîç</span>
            <input type="text" placeholder="ÊêúÁ¥¢Â∫îÁî®Êàñ‰∏ãËΩΩÈìæÊé•" readonly value="">
        </div>

        <!-- Â∫îÁî®Âç°ÁâáÁΩëÊ†º -->
        <div class="apps-grid" id="appsGrid"></div>
    </div>

    <!-- Â∫ïÈÉ®ÂØºËà™Ê†è -->
    <div class="bottom-nav" id="bottomNav">
        <button class="nav-item active" data-cat="apps"><i>üì±</i> Â∫îÁî®</button>
        <button class="nav-item" data-cat="games"><i>üéÆ</i> Ê∏∏Êàè</button>
        <button class="nav-item" data-cat="movies"><i>üé¨</i> ÁîµÂΩ±</button>
        <button class="nav-item" data-cat="music"><i>üéµ</i> Èü≥‰πê</button>
        <button class="nav-item" data-cat="books"><i>üìö</i> Âõæ‰π¶</button>
    </div>

    <!-- Ê∑ªÂä†/ÁºñËæëÂºπÁ™ó -->
    <div class="modal" id="appModal">
        <div class="modal-card">
            <h2 id="modalTitle">Ê∑ªÂä†Â∫îÁî®Âà∞Êî∂Ëóè</h2>
            
            <div class="input-field">
                <label>Â∫îÁî®ÂêçÁß∞</label>
                <input type="text" id="appName" placeholder="‰æãÂ¶Ç: ÊàëÁöÑÂ∫îÁî®">
            </div>

            <div class="input-field">
                <label>‰∏ãËΩΩÈìæÊé• (Loadly.io)</label>
                <div class="url-input-row">
                    <input type="url" id="appUrl" placeholder="https://loadly.io/..." value="https://loadly.io/">
                    <button class="fetch-btn" id="fetchInfoBtn">Ëé∑Âèñ</button>
                </div>
                <div id="fetchStatus" class="fetch-status"></div>
            </div>

            <div class="input-field">
                <label>Âπ≥Âè∞</label>
                <div class="platform-selector" id="platformSelector">
                    <div class="platform-option selected" data-platform="ios"><i>üçé</i> iOS</div>
                    <div class="platform-option" data-platform="android"><i>ü§ñ</i> Android</div>
                </div>
                <input type="hidden" id="appPlatform" value="ios">
            </div>

            <div class="input-field">
                <label>ÂàÜÁ±ª</label>
                <select id="appCategory">
                    <option value="apps">üì± Â∫îÁî®</option>
                    <option value="games">üéÆ Ê∏∏Êàè</option>
                    <option value="movies">üé¨ ÁîµÂΩ±</option>
                    <option value="music">üéµ Èü≥‰πê</option>
                    <option value="books">üìö Âõæ‰π¶</option>
                </select>
            </div>

            <div class="input-field">
                <label>ÂõæÊ†á (ÂèØÈÄâ)</label>
                <input type="file" id="appIcon" accept="image/*">
                <div class="hint-text">ÁÇπÂáªÂ∫îÁî®ÂõæÊ†á5Ê¨°‰πüÂèØÊõ¥Êç¢</div>
            </div>

            <div class="modal-actions">
                <button class="modal-btn secondary" id="cancelModalBtn">ÂèñÊ∂à</button>
                <button class="modal-btn primary" id="saveAppBtn">‰øùÂ≠ò</button>
            </div>
        </div>
    </div>

    <!-- ÊêúÁ¥¢È°µÈù¢ -->
    <div class="search-overlay" id="searchOverlay">
        <div class="search-header">
            <button class="back-btn" id="closeSearchBtn">‚Üê ËøîÂõû</button>
            <div class="search-input-box">
                <span>üîç</span>
                <input type="text" id="searchInput" placeholder="ÊêúÁ¥¢Â∫îÁî®ÂêçÁß∞Êàñ‰∏ãËΩΩÈìæÊé•...">
            </div>
        </div>
        <div class="search-results" id="searchResults"></div>
    </div>

    <script>
        (function() {
            // ========== ËÆæÂ§áÊ£ÄÊµã ==========
            function detectDevice() {
                const ua = navigator.userAgent || navigator.vendor || window.opera;
                
                // Ê£ÄÊµãÂÆâÂçì
                if (/android/i.test(ua)) {
                    return 'android';
                }
                
                // Ê£ÄÊµãiOS
                if (/iPad|iPhone|iPod/.test(ua) && !window.MSStream) {
                    return 'ios';
                }
                
                // Ê£ÄÊµãMacÔºà‰πüÂΩí‰∏∫iOSÈ£éÊ†ºÔºâ
                if (/Macintosh|Mac OS X/.test(ua)) {
                    return 'ios';
                }
                
                // ÈªòËÆ§ËøîÂõûios
                return 'ios';
            }

            const deviceType = detectDevice();
            const themeClass = deviceType === 'android' ? 'android-theme' : 'ios-theme';
            
            console.log('Ê£ÄÊµãÂà∞ËÆæÂ§á:', deviceType, '‰ΩøÁî®‰∏ªÈ¢ò:', themeClass);

            // ========== Â∫îÁî®‰∏ªÈ¢ò ==========
            function applyTheme() {
                // ÂõæÊ†á
                const logoIcon = document.getElementById('logoIcon');
                logoIcon.classList.add(themeClass);
                
                // Ê∑ªÂä†ÊåâÈíÆ
                const addBtn = document.getElementById('openAddModalBtn');
                addBtn.classList.add(themeClass);
                
                // Â∫ïÈÉ®ÂØºËà™È°π
                const navItems = document.querySelectorAll('.nav-item');
                navItems.forEach(item => {
                    if (item.classList.contains('active')) {
                        item.classList.add(themeClass);
                    }
                });
                
                // ÊâÄÊúâ‰∏ãËΩΩÂæΩÁ´†ÔºàÂêéÁª≠Âä®ÊÄÅÊ∑ªÂä†ÁöÑ‰πü‰ºöÂ§ÑÁêÜÔºâ
            }

            // ‰∏∫Âä®ÊÄÅÁîüÊàêÁöÑ‰∏ãËΩΩÂæΩÁ´†Ê∑ªÂä†‰∏ªÈ¢ò
            function styleDownloadBadge(badge) {
                if (badge) {
                    badge.classList.add(themeClass);
                }
            }

            // ========== Êï∞ÊçÆÂ≠òÂÇ® ==========
            let apps = [];
            let currentCategory = 'apps';
            let editingId = null;
            let selectedPlatform = 'ios';
            let appsClickCount = 0;
            let versionTimer = null;

            // ÂØºÂá∫ËÆ°Êï∞Âô®
            let exportClickCount = 0;
            let exportTimer = null;

            // Âä†ËΩΩ‰øùÂ≠òÁöÑÊï∞ÊçÆ
            try {
                const saved = localStorage.getItem('appstore_apps_data');
                if (saved) apps = JSON.parse(saved);
            } catch (e) { apps = []; }

            // ÈªòËÆ§Á§∫‰æãÊï∞ÊçÆ
            if (apps.length === 0) {
                apps.push({
                    id: 'example-' + Date.now(),
                    name: 'Á§∫‰æãÂ∫îÁî®',
                    url: 'https://loadly.io/',
                    platform: 'ios',
                    category: 'apps',
                    iconData: null
                });
            }

            function saveApps() {
                try { localStorage.setItem('appstore_apps_data', JSON.stringify(apps)); } catch (e) {}
            }

            // DOM ÂÖÉÁ¥†
            const grid = document.getElementById('appsGrid');
            const modal = document.getElementById('appModal');
            const modalTitle = document.getElementById('modalTitle');
            const appName = document.getElementById('appName');
            const appUrl = document.getElementById('appUrl');
            const appPlatform = document.getElementById('appPlatform');
            const appCategory = document.getElementById('appCategory');
            const appIcon = document.getElementById('appIcon');
            const cancelBtn = document.getElementById('cancelModalBtn');
            const saveBtn = document.getElementById('saveAppBtn');
            const addBtn = document.getElementById('openAddModalBtn');
            const fetchInfoBtn = document.getElementById('fetchInfoBtn');
            const fetchStatus = document.getElementById('fetchStatus');
            const navItems = document.querySelectorAll('.nav-item');
            const openSearchBtn = document.getElementById('openSearchBtn');
            const closeSearchBtn = document.getElementById('closeSearchBtn');
            const searchOverlay = document.getElementById('searchOverlay');
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            const versionToast = document.getElementById('versionToast');
            const platformOptions = document.querySelectorAll('.platform-option');

            // Â∫îÁî®‰∏ªÈ¢ò
            applyTheme();

            // Âπ≥Âè∞ÈÄâÊã©
            platformOptions.forEach(opt => {
                opt.addEventListener('click', () => {
                    platformOptions.forEach(o => o.classList.remove('selected'));
                    opt.classList.add('selected');
                    appPlatform.value = opt.dataset.platform;
                });
            });

            // ÊòæÁ§∫ÁâàÊú¨Âè∑
            function showVersion() {
                versionToast.classList.add('show');
                setTimeout(() => versionToast.classList.remove('show'), 2000);
            }

            // ÁÇπÂáªlogoËß¶ÂèëÁâàÊú¨Âè∑ÂíåÂØºÂá∫
            document.querySelector('.logo-icon').addEventListener('click', () => {
                appsClickCount++;
                if (versionTimer) clearTimeout(versionTimer);
                versionTimer = setTimeout(() => appsClickCount = 0, 3000);
                if (appsClickCount >= 5) { 
                    showVersion(); 
                    appsClickCount = 0;
                    
                    exportClickCount++;
                    if (exportTimer) clearTimeout(exportTimer);
                    exportTimer = setTimeout(() => exportClickCount = 0, 3000);
                    if (exportClickCount >= 3) {
                        performExport();
                        exportClickCount = 0;
                    }
                }
            });

            // ÂØºÂá∫ÂäüËÉΩ
            function performExport() {
                if (apps.length === 0) { alert('Ê≤°ÊúâÊï∞ÊçÆÂèØÂØºÂá∫'); return; }
                
                const backup = {
                    version: '1.0',
                    timestamp: new Date().toISOString(),
                    apps: apps
                };
                
                const blob = new Blob([JSON.stringify(backup, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'appstore_backup_' + new Date().toISOString().slice(0,10) + '.json';
                a.click();
                URL.revokeObjectURL(url);
                alert('‚úÖ Â§á‰ªΩÂ∑≤ÂØºÂá∫');
            }

            // Ëé∑ÂèñÁΩëÂùÄ‰ø°ÊÅØ
            fetchInfoBtn.addEventListener('click', () => {
                const url = appUrl.value.trim();
                if (!url) { alert('ËØ∑ËæìÂÖ•‰∏ãËΩΩÈìæÊé•'); return; }
                
                fetchStatus.innerText = 'Ê≠£Âú®Ëé∑Âèñ‰ø°ÊÅØ...';
                
                try {
                    const urlObj = new URL(url);
                    let hostname = urlObj.hostname.replace('www.', '');
                    let path = urlObj.pathname.split('/').pop() || '';
                    
                    if (path && path.length > 3) {
                        appName.value = decodeURIComponent(path).replace(/\.(ipa|apk)$/i, '');
                    } else {
                        appName.value = hostname.split('.')[0];
                    }
                    
                    if (url.includes('.ipa') || url.includes('ios') || url.includes('iPhone')) {
                        appPlatform.value = 'ios';
                        platformOptions.forEach(o => {
                            o.classList.toggle('selected', o.dataset.platform === 'ios');
                        });
                    } else if (url.includes('.apk') || url.includes('android')) {
                        appPlatform.value = 'android';
                        platformOptions.forEach(o => {
                            o.classList.toggle('selected', o.dataset.platform === 'android');
                        });
                    }
                    
                    fetchStatus.innerText = '‚úì Â∑≤‰ªéÈìæÊé•ÊèêÂèñÂêçÁß∞';
                } catch {
                    fetchStatus.innerText = 'ËØ∑ËæìÂÖ•ÊúâÊïàÈìæÊé•';
                }
            });

            // Ê∏≤Êüì‰∏ªÁΩëÊ†º
            function renderGrid() {
                let filtered = apps;
                if (currentCategory !== 'all') {
                    filtered = apps.filter(app => app.category === currentCategory);
                }

                if (filtered.length === 0) {
                    grid.innerHTML = `
                        <div class="empty-message">
                            <div class="big-icon">üì¶</div>
                            <div>ËøòÊ≤°ÊúâÊî∂ËóèÂ∫îÁî®</div>
                            <div class="hint">ÁÇπÂáª"Ê∑ªÂä†"ÊåâÈíÆÂºÄÂßãÊî∂Ëóè‰∏ãËΩΩÈìæÊé•</div>
                        </div>`;
                    return;
                }

                let html = '';
                filtered.forEach(app => {
                    let iconHtml = '';
                    if (app.iconData) {
                        iconHtml = `<img src="${app.iconData}" alt="">`;
                    } else {
                        const platformIcon = app.platform === 'ios' ? 'üçé' : 'ü§ñ';
                        iconHtml = `<div class="app-icon placeholder">${platformIcon}</div>`;
                    }

                    const platformTag = app.platform === 'ios' ? 'iOS' : 'Android';
                    
                    html += `
                        <div class="app-card" data-id="${app.id}">
                            <div class="app-icon image-clickable" data-id="${app.id}">
                                ${iconHtml}
                            </div>
                            <div class="app-info" onclick="window.open('${app.url}', '_blank')">
                                <div class="app-name">
                                    ${app.name}
                                    <span class="app-platform">${platformTag}</span>
                                </div>
                                <div class="app-url-preview">${app.url}</div>
                                <div style="margin-top: 6px;">
                                    <span class="download-badge ${themeClass}">
                                        ‚¨áÔ∏è ‰∏ãËΩΩ
                                    </span>
                                </div>
                            </div>
                            <div class="app-actions">
                                <button class="corner-btn edit-btn" data-id="${app.id}">‚úèÔ∏è</button>
                                <button class="corner-btn delete-btn" data-id="${app.id}">üóëÔ∏è</button>
                            </div>
                        </div>
                    `;
                });
                grid.innerHTML = html;

                // ÂõæÁâáÁÇπÂáªÊõ¥Êç¢
                document.querySelectorAll('.image-clickable').forEach(imgDiv => {
                    const id = imgDiv.dataset.id;
                    let clickCount = 0;
                    let timer = null;
                    
                    imgDiv.addEventListener('click', (e) => {
                        e.stopPropagation();
                        clickCount++;
                        if (timer) clearTimeout(timer);
                        timer = setTimeout(() => clickCount = 0, 3000);
                        
                        if (clickCount >= 5) {
                            clickCount = 0;
                            const app = apps.find(a => a.id === id);
                            if (app) {
                                const input = document.createElement('input');
                                input.type = 'file';
                                input.accept = 'image/*';
                                input.onchange = (e) => {
                                    const file = e.target.files[0];
                                    if (file) {
                                        const reader = new FileReader();
                                        reader.onload = (re) => {
                                            app.iconData = re.target.result;
                                            saveApps();
                                            renderGrid();
                                        };
                                        reader.readAsDataURL(file);
                                    }
                                };
                                input.click();
                            }
                        }
                    });
                });

                // ÁºñËæë
                document.querySelectorAll('.edit-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const id = btn.dataset.id;
                        const app = apps.find(a => a.id === id);
                        if (app) {
                            editingId = id;
                            modalTitle.innerText = 'ÁºñËæëÂ∫îÁî®';
                            appName.value = app.name || '';
                            appUrl.value = app.url || '';
                            appCategory.value = app.category || 'apps';
                            appPlatform.value = app.platform || 'ios';
                            
                            platformOptions.forEach(o => {
                                o.classList.toggle('selected', o.dataset.platform === app.platform);
                            });
                            
                            appIcon.value = '';
                            fetchStatus.innerText = '';
                            modal.classList.add('show');
                        }
                    });
                });

                // Âà†Èô§
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const id = btn.dataset.id;
                        if (confirm('Á°ÆÂÆöÂà†Èô§Ëøô‰∏™Â∫îÁî®ÂêóÔºü')) {
                            apps = apps.filter(a => a.id !== id);
                            saveApps();
                            renderGrid();
                        }
                    });
                });
            }

            // Ê∑ªÂä†ÊåâÈíÆ
            addBtn.addEventListener('click', () => {
                editingId = null;
                modalTitle.innerText = 'Ê∑ªÂä†Â∫îÁî®Âà∞Êî∂Ëóè';
                appName.value = '';
                appUrl.value = 'https://loadly.io/';
                appCategory.value = 'apps';
                appPlatform.value = 'ios';
                platformOptions.forEach(o => {
                    o.classList.toggle('selected', o.dataset.platform === 'ios');
                });
                appIcon.value = '';
                fetchStatus.innerText = '';
                modal.classList.add('show');
            });

            cancelBtn.addEventListener('click', () => {
                modal.classList.remove('show');
            });

            saveBtn.addEventListener('click', () => {
                const name = appName.value.trim();
                let url = appUrl.value.trim();
                const category = appCategory.value;
                const platform = appPlatform.value;
                
                if (!name) { alert('ËØ∑ËæìÂÖ•Â∫îÁî®ÂêçÁß∞'); return; }
                if (!url) { alert('ËØ∑ËæìÂÖ•‰∏ãËΩΩÈìæÊé•'); return; }
                
                if (!url.startsWith('http')) {
                    url = 'https://' + url;
                }

                const file = appIcon.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => saveApp(name, url, category, platform, e.target.result);
                    reader.readAsDataURL(file);
                } else {
                    saveApp(name, url, category, platform, null);
                }
            });

            function saveApp(name, url, category, platform, iconData) {
                if (editingId) {
                    const idx = apps.findIndex(a => a.id === editingId);
                    if (idx !== -1) {
                        apps[idx].name = name;
                        apps[idx].url = url;
                        apps[idx].category = category;
                        apps[idx].platform = platform;
                        if (iconData) apps[idx].iconData = iconData;
                    }
                } else {
                    apps.push({
                        id: Date.now() + '-' + Math.random().toString(36).substr(2, 6),
                        name, url, category, platform, iconData
                    });
                }
                saveApps();
                renderGrid();
                modal.classList.remove('show');
            }

            // Â∫ïÈÉ®ÂØºËà™ÂàÜÁ±ªÂàáÊç¢
            function setActiveNav(cat) {
                navItems.forEach(item => {
                    item.classList.remove('active', 'ios-theme', 'android-theme');
                    if (item.dataset.cat === cat) {
                        item.classList.add('active', themeClass);
                    }
                });
            }

            navItems.forEach(item => {
                item.addEventListener('click', () => {
                    currentCategory = item.dataset.cat;
                    setActiveNav(currentCategory);
                    renderGrid();
                });
            });

            // ÊêúÁ¥¢ÂäüËÉΩ
            function performSearch(keyword) {
                keyword = keyword.toLowerCase().trim();
                if (keyword === '') return [];
                
                return apps.filter(app => 
                    app.name.toLowerCase().includes(keyword) || 
                    app.url.toLowerCase().includes(keyword)
                );
            }

            function renderSearchResults(results) {
                if (results.length === 0) {
                    searchResults.innerHTML = '<div class="empty-message">Ê≤°ÊúâÊâæÂà∞ÂåπÈÖçÁöÑÂ∫îÁî®</div>';
                    return;
                }
                
                let html = '';
                results.forEach(app => {
                    const platformIcon = app.platform === 'ios' ? 'üçé' : 'ü§ñ';
                    html += `
                        <div class="app-card" data-id="${app.id}" style="margin-bottom: 8px;">
                            <div class="app-icon">${platformIcon}</div>
                            <div class="app-info" onclick="window.open('${app.url}', '_blank')">
                                <div class="app-name">${app.name}</div>
                                <div class="app-url-preview">${app.url}</div>
                            </div>
                        </div>
                    `;
                });
                searchResults.innerHTML = html;
            }

            openSearchBtn.addEventListener('click', () => {
                searchOverlay.classList.add('show');
                searchInput.value = '';
                searchInput.focus();
                renderSearchResults([]);
            });

            closeSearchBtn.addEventListener('click', () => {
                searchOverlay.classList.remove('show');
            });

            searchInput.addEventListener('input', () => {
                const results = performSearch(searchInput.value);
                renderSearchResults(results);
            });

            // Ê®°ÊÄÅÊ°ÜÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.classList.remove('show');
            });

            // ÂàùÂßãÂåñ
            setActiveNav(currentCategory);
            renderGrid();
        })();
    </script>
</body>
</html>